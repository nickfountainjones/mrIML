<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>mrIML • mrIML</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="mrIML">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">mrIML</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">2.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/mrIML.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/Landscape%20genetics%20(classification).html">Landscape genetics (classification)</a></li>
    <li><a class="dropdown-item" href="../articles/Regression.html">Regression</a></li>
    <li><a class="dropdown-item" href="../articles/Graphical%20network%20model%20(GNM).html">Graphical network model (GNM)</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Other</h6></li>
    <li><a class="dropdown-item" href="../articles/Common%20errors%20in%20mrIML.html">Common errors in mrIML</a></li>
    <li><a class="dropdown-item" href="../articles/Microbiome%20data%20curation.html">Microbiome data curation</a></li>
    <li><a class="dropdown-item" href="../articles/Swine%20biosecurity.html">Swine biosecurity</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="nav-link" href="https://github.com/nickfountainjones/mrIML/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>mrIML</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/nickfountainjones/mrIML/blob/master/vignettes/mrIML.Rmd"><code>vignettes/mrIML.Rmd</code></a></small>
      <div class="d-none name"><code>mrIML.Rmd</code></div>
    </div>

    
    
<p><code>mrIML</code> is a package for interpretable machine learning in
R, specifically designed for multivariate (or multi-response) data. It
provides tools for building and interpreting multi-response models using
the <a href="https://www.tidymodels.org/start/" class="external-link"><code>tidymodels</code></a>
syntax; making it very useful for applications in community ecology and
ecological genomics.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/nickfountainjones/mrIML">mrIML</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidymodels.tidymodels.org" class="external-link">tidymodels</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/mayer79/flashlight" class="external-link">flashlight</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com" class="external-link">patchwork</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">7007</span><span class="op">)</span></span></code></pre></div>
<p>Here we demonstrate a basic <code>mrIML</code> workflow using the
<code>Bird.parasites</code> data set from the <code>MRFcov</code>
package. This data set contains binary occurrences of four blood
parasite species–<em>Hzosteropis, Hkillangoi, Plas, and
Microfilaria</em>–in New Caledonian birds and a scaled continuous
variable representing host relative abundance:
<em>scale.prop.zos</em>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">MRFcov</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/MRFcov/man/Bird.parasites.html" class="external-link">Bird.parasites</a></span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 5</span></span></span>
<span><span class="co">#&gt;   Hzosteropis Hkillangoi  Plas Microfilaria scale.prop.zos</span></span>
<span><span class="co">#&gt;         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>           0          0     0            0          -<span style="color: #BB0000;">1.09</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>           0          0     0            0          -<span style="color: #BB0000;">1.09</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>           0          0     0            0          -<span style="color: #BB0000;">1.09</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>           0          0     0            0          -<span style="color: #BB0000;">1.09</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span>           0          0     0            0          -<span style="color: #BB0000;">1.09</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span>           0          0     0            0          -<span style="color: #BB0000;">1.09</span></span></span></code></pre></div>
<p>To fit a multi-response models, we must first separate the data into
the responses, the variables we wish to predict, and the covariates, the
variables used only as predictors.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Responses</span></span>
<span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">data</span>, <span class="st">"Hzosteropis"</span>, <span class="st">"Hkillangoi"</span>, <span class="st">"Plas"</span>, <span class="st">"Microfilaria"</span><span class="op">)</span></span>
<span><span class="co"># Covariates</span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">data</span>, <span class="st">"scale.prop.zos"</span><span class="op">)</span></span></code></pre></div>
<p>Many of the functions in the <code>mrIML</code> wrokflow that follows
can be greatly sped up by using parallel processing. To do this, we just
need to set up a cluster using the <code>future</code> package.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">future</span><span class="fu">::</span><span class="fu"><a href="https://future.futureverse.org/reference/plan.html" class="external-link">plan</a></span><span class="op">(</span><span class="va">multisession</span>, workers <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="fitting-a-mriml-model">Fitting a mrIML model<a class="anchor" aria-label="anchor" href="#fitting-a-mriml-model"></a>
</h2>
<p>The first step in the <code>mrIML</code> workflow is to define some
models that we would like to compare. Thanks to <code>tidymodels</code>,
we can define a wide range of models using a unified syntax. To
demonstrate, we are going to set up two models to compare: a random
forest model (RF) and a logistic regression (lm).</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model_rf</span> <span class="op">&lt;-</span> <span class="fu">rand_forest</span><span class="op">(</span></span>
<span>  trees <span class="op">=</span> <span class="fl">100</span>, <span class="co"># 100 trees are set for brevity. Aim to start with 1000.</span></span>
<span>  mode <span class="op">=</span> <span class="st">"classification"</span>,</span>
<span>  mtry <span class="op">=</span> <span class="fu">tune</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  min_n <span class="op">=</span> <span class="fu">tune</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">set_engine</span><span class="op">(</span><span class="st">"randomForest"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">model_lm</span> <span class="op">&lt;-</span> <span class="fu">logistic_reg</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">set_engine</span><span class="op">(</span><span class="st">"glm"</span><span class="op">)</span></span></code></pre></div>
<p>The models can then be fit as multi-response models using
<code><a href="../reference/mrIMLpredicts.html">mrIMLpredicts()</a></code>, which is the work horse of the
<code>mrIML</code> package. <code><a href="../reference/mrIMLpredicts.html">mrIMLpredicts()</a></code> fits the
supplied tidymodel to each response variables. The <code>X1</code>
argument can be used to supply any response variables that we would like
to also use as predictors; which results in a co-ocurance model (in this
case we use all the response variables).</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mrIML_rf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mrIMLpredicts.html">mrIMLpredicts</a></span><span class="op">(</span></span>
<span>  X <span class="op">=</span> <span class="va">X</span>,</span>
<span>  Y <span class="op">=</span> <span class="va">Y</span>,</span>
<span>  X1 <span class="op">=</span> <span class="va">Y</span>,</span>
<span>  Model <span class="op">=</span> <span class="va">model_rf</span>,</span>
<span>  prop <span class="op">=</span> <span class="fl">0.7</span>,</span>
<span>  k <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  racing <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">mrIML_lm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mrIMLpredicts.html">mrIMLpredicts</a></span><span class="op">(</span></span>
<span>  X <span class="op">=</span> <span class="va">X</span>,</span>
<span>  Y <span class="op">=</span> <span class="va">Y</span>,</span>
<span>  X1 <span class="op">=</span> <span class="va">Y</span>,</span>
<span>  Model <span class="op">=</span> <span class="va">model_lm</span> , </span>
<span>  balance_data <span class="op">=</span> <span class="st">'no'</span>,</span>
<span>  prop <span class="op">=</span> <span class="fl">0.6</span>,</span>
<span>  k <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  racing <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The resulting fitted <code>mrIML</code> model is a list object
containing the original tidy model, the data, and the fitted response
models. The remainder of the functions in the <code>mrIML</code> package
are aimed at interrogating, explaining, and comparing these fitted
<code>mrIML</code> models.</p>
</div>
<div class="section level2">
<h2 id="model-performance-and-comparison">Model performance and comparison<a class="anchor" aria-label="anchor" href="#model-performance-and-comparison"></a>
</h2>
<p><code><a href="../reference/mrIMLperformance.html">mrIMLperformance()</a></code> is another core function in
<code>mrIML</code> used to extract performance metrics for each of the
fitted response models inside the multi-response <code>mrIML</code>
model.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">perf_rf</span> <span class="op">&lt;-</span> <span class="va">mrIML_rf</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/mrIMLperformance.html">mrIMLperformance</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">perf_rf</span><span class="op">$</span><span class="va">model_performance</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 4 × 8</span></span></span>
<span><span class="co">#&gt;   response     model_name roc_AUC   mcc sensitivity   ppv specificity prevalence</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Hzosteropis  rand_fore…   0.951 0.714       0.941 0.923       0.758     0.265 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Hkillangoi   rand_fore…   0.790 0.218       0.918 0.926       0.308     0.116 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> Plas         rand_fore…   0.902 0.438       0.955 0.875       0.4       0.196 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> Microfilaria rand_fore…   0.905 0           1     0.896       0         0.098<span style="text-decoration: underline;">0</span></span></span>
<span></span>
<span><span class="va">perf_lm</span> <span class="op">&lt;-</span> <span class="va">mrIML_lm</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/mrIMLperformance.html">mrIMLperformance</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">perf_rf</span><span class="op">$</span><span class="va">model_performance</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 4 × 8</span></span></span>
<span><span class="co">#&gt;   response     model_name roc_AUC   mcc sensitivity   ppv specificity prevalence</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Hzosteropis  rand_fore…   0.951 0.714       0.941 0.923       0.758     0.265 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Hkillangoi   rand_fore…   0.790 0.218       0.918 0.926       0.308     0.116 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> Plas         rand_fore…   0.902 0.438       0.955 0.875       0.4       0.196 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> Microfilaria rand_fore…   0.905 0           1     0.896       0         0.098<span style="text-decoration: underline;">0</span></span></span></code></pre></div>
<p>These performance metrics can be compared between different
<code>mrIML</code> model using <code><a href="../reference/mrPerformancePlot.html">mrPerformancePlot()</a></code>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">perf_comp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mrPerformancePlot.html">mrPerformancePlot</a></span><span class="op">(</span><span class="va">perf_rf</span>, <span class="va">perf_lm</span><span class="op">)</span></span>
<span><span class="va">perf_comp</span><span class="op">$</span><span class="va">performance_plot</span> <span class="op">+</span> <span class="va">perf_comp</span><span class="op">$</span><span class="va">performance_diff_plot</span></span></code></pre></div>
<p><img src="mrIML_files/figure-html/compare-mrIML-1.png" width="672"></p>
</div>
<div class="section level2">
<h2 id="interogating-models">Interogating models<a class="anchor" aria-label="anchor" href="#interogating-models"></a>
</h2>
<p>To explore the effect of predictors on the different response models,
<code>mrIML</code> works closely with the <a href="https://mayer79.github.io/flashlight/index.html" class="external-link"><code>flashlight</code></a>
package, particularly their implementation of
<code><a href="https://rdrr.io/pkg/flashlight/man/light_profile.html" class="external-link">flashlight::light_profile()</a></code> to generate partial dependency
curves (PDs) for model agnostic comparisons. The
<code><a href="../reference/mrFlashlight.html">mrFlashlight()</a></code> function can be used to convert a
<code>mrIML</code> model into a <code>flashlight</code> object in order
to apply most of the <code>flashlight</code> functions.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fl_rf</span> <span class="op">&lt;-</span> <span class="va">mrIML_rf</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/mrFlashlight.html">mrFlashlight</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fl_rf</span><span class="op">$</span><span class="va">Microfilaria</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/flashlight/man/light_profile.html" class="external-link">light_profile</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>, v <span class="op">=</span> <span class="st">"scale.prop.zos"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Effect of scale.prop.zos on Microfilaria"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="mrIML_files/figure-html/unnamed-chunk-2-1.png" width="672"></p>
<p><code><a href="../reference/mrCovar.html">mrCovar()</a></code> is a wrapper around
<code><a href="../reference/mrFlashlight.html">mrFlashlight()</a></code> and <code><a href="https://rdrr.io/pkg/flashlight/man/light_profile.html" class="external-link">flashlight::light_profile()</a></code>
to quickly compare the effect of a predictive covariate across the many
response models.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">PD_scale.prop.zos_rf</span> <span class="op">&lt;-</span> <span class="va">mrIML_rf</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/mrCovar.html">mrCovar</a></span><span class="op">(</span>var <span class="op">=</span> <span class="st">"scale.prop.zos"</span>, sdthresh <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span></span>
<span><span class="va">PD_scale.prop.zos_rf</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">/</span></span>
<span>  <span class="va">PD_scale.prop.zos_rf</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span> <span class="op">/</span></span>
<span>  <span class="va">PD_scale.prop.zos_rf</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html" class="external-link">plot_layout</a></span><span class="op">(</span>axis <span class="op">=</span> <span class="st">"collect"</span><span class="op">)</span></span></code></pre></div>
<p><img src="mrIML_files/figure-html/unnamed-chunk-3-1.png" width="672"></p>
<p>Since PDs are model agnostic, we can use them for any kind of
predictive model. For example we can compare the RF model results above
directly with the LM bellow. We could even compare a Neural Net if we
had enough data to fit it!</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">PD_scale.prop.zos_lm</span> <span class="op">&lt;-</span> <span class="va">mrIML_lm</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/mrCovar.html">mrCovar</a></span><span class="op">(</span>var <span class="op">=</span> <span class="st">"scale.prop.zos"</span>, sdthresh <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span></span>
<span><span class="va">PD_scale.prop.zos_lm</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">/</span></span>
<span>  <span class="va">PD_scale.prop.zos_lm</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span> <span class="op">/</span></span>
<span>  <span class="va">PD_scale.prop.zos_lm</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html" class="external-link">plot_layout</a></span><span class="op">(</span>axis <span class="op">=</span> <span class="st">"collect"</span><span class="op">)</span></span></code></pre></div>
<p><img src="mrIML_files/figure-html/unnamed-chunk-4-1.png" width="672"></p>
<p>The variability in the response probability across a PD curve can be
used to rank variable importance in each response model. On this basis,
<code><a href="../reference/mrVip.html">mrVip()</a></code> compares variable importance across the response
models inside a <code>mrIML</code> model.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">vip_rf</span> <span class="op">&lt;-</span> <span class="va">mrIML_rf</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/mrVip.html">mrVip</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">vip_rf</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<p><img src="mrIML_files/figure-html/unnamed-chunk-5-1.png" width="672"></p>
<p>If there are many response models and/or covariates, the
<code>threshold</code>, <code>global_top_var</code>, and
<code>local_top_var</code> arguments can be used to filter the variable
importance results that are plotted by <code>mrVip</code>. The
<code>taxa</code> argument can also be used to plot a desired response
model that may not fit the filtering criteria. See <code>?mrVip()</code>
for the specifics of these arguments.</p>
</div>
<div class="section level2">
<h2 id="bootstrapping-for-uncertainty">Bootstrapping for uncertainty<a class="anchor" aria-label="anchor" href="#bootstrapping-for-uncertainty"></a>
</h2>
<p>To quantify uncertainty in a <code>mrIML</code> model, the function
<code><a href="../reference/mrBootstrap.html">mrBootstrap()</a></code> bootstraps the PDs. The output can then be
passed to <code><a href="../reference/mrPdPlotBootstrap.html">mrPdPlotBootstrap()</a></code> to visualize the PDs.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mrIML_boot_rf</span> <span class="op">&lt;-</span> <span class="va">mrIML_rf</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/mrBootstrap.html">mrBootstrap</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |==                                                                    |   2%  |                                                                              |====                                                                  |   5%  |                                                                              |=====                                                                 |   8%  |                                                                              |=======                                                               |  10%  |                                                                              |=========                                                             |  12%  |                                                                              |==========                                                            |  15%  |                                                                              |============                                                          |  18%  |                                                                              |==============                                                        |  20%  |                                                                              |================                                                      |  22%  |                                                                              |==================                                                    |  25%  |                                                                              |===================                                                   |  28%  |                                                                              |=====================                                                 |  30%  |                                                                              |=======================                                               |  32%  |                                                                              |========================                                              |  35%  |                                                                              |==========================                                            |  38%  |                                                                              |============================                                          |  40%  |                                                                              |==============================                                        |  42%  |                                                                              |================================                                      |  45%  |                                                                              |=================================                                     |  48%  |                                                                              |===================================                                   |  50%  |                                                                              |=====================================                                 |  52%  |                                                                              |======================================                                |  55%  |                                                                              |========================================                              |  58%  |                                                                              |==========================================                            |  60%  |                                                                              |============================================                          |  62%  |                                                                              |==============================================                        |  65%  |                                                                              |===============================================                       |  68%  |                                                                              |=================================================                     |  70%  |                                                                              |===================================================                   |  72%  |                                                                              |====================================================                  |  75%  |                                                                              |======================================================                |  78%  |                                                                              |========================================================              |  80%  |                                                                              |==========================================================            |  82%  |                                                                              |============================================================          |  85%  |                                                                              |=============================================================         |  88%  |                                                                              |===============================================================       |  90%  |                                                                              |=================================================================     |  92%  |                                                                              |==================================================================    |  95%  |                                                                              |====================================================================  |  98%  |                                                                              |======================================================================| 100%</span></span>
<span></span>
<span><span class="fu"><a href="../reference/mrPdPlotBootstrap.html">mrPdPlotBootstrap</a></span><span class="op">(</span></span>
<span>  <span class="va">mrIML_rf</span>,</span>
<span>  mrBootstrap_obj <span class="op">=</span> <span class="va">mrIML_boot_rf</span>,</span>
<span>  target <span class="op">=</span> <span class="st">"Plas"</span>,</span>
<span>  global_top_var <span class="op">=</span> <span class="fl">4</span></span>
<span><span class="op">)</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<p><img src="mrIML_files/figure-html/unnamed-chunk-6-1.png" width="672"></p>
<p>After bootstrapping the PDs, the bootstrap information can be
supplied to <code><a href="../reference/mrVip.html">mrVip()</a></code> to include uncertainty bounds in the
plots.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">vip_boot_rf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mrVip.html">mrVip</a></span><span class="op">(</span></span>
<span>  mrIMLobj <span class="op">=</span> <span class="va">mrIML_rf</span>,</span>
<span>  mrBootstrap_obj <span class="op">=</span> <span class="va">mrIML_boot_rf</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">vip_boot_rf</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<p><img src="mrIML_files/figure-html/unnamed-chunk-7-1.png" width="672"></p>
</div>
<div class="section level2">
<h2 id="checking-for-interactions">Checking for interactions<a class="anchor" aria-label="anchor" href="#checking-for-interactions"></a>
</h2>
<p>Another helpful investigative tool is <code>mrInteraction()</code>.
This function quickly identifies which response models have strong
evidence of interactions between predictors, which predictors have the
most interactive effects, and which interactions are the strongest.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">interactions_rf</span> <span class="op">&lt;-</span> <span class="va">mrIML_rf</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/mrInteractions.html">mrInteractions</a></span><span class="op">(</span>feature <span class="op">=</span> <span class="st">"Plas"</span>, num_bootstrap <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span><span class="va">interactions_rf</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">/</span></span>
<span>  <span class="va">interactions_rf</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span> <span class="op">/</span></span>
<span>  <span class="va">interactions_rf</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<p><img src="mrIML_files/figure-html/unnamed-chunk-8-1.png" width="672"></p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://discover.utas.edu.au/Nick.FountainJones" class="external-link">Nick Fountain-Jones</a>, Ryan Leadbetter, <a href="https://machado-lab.github.io/" class="external-link">Gustavo Machado</a>, Chris Kozakiewicz, Nick Clark.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer>
</div>





  </body>
</html>
